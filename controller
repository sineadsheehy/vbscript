Set oIE = CreateObject("InternetExplorer.Application")oIE.visible = TrueSet oLog = CreateObject("Scripting.FileSystemObject")oOutputFile = "./test-log.txt"Set sTextOutput = oLog.OpenTextFile(oOutputFile, 2, True)'---------------------------------------------------------Sub WaitForLoad  Do While oIE.Busy    WScript.sleep 500  LoopEnd Sub'------------------------------------------------------------Sub CountElements set oElems = oIE.Document.getElementsByTagName("li") iCount = oElems.length For Each item In oElems  sMenuItem = sMenuItem & item.innerText & ", "  NextEnd Sub'--------------------------------------------------------------Sub Header sTextOutput.WriteLine("Testing started at " & Date & " " & Time) End SubSub Result sTextOutput.WriteLine("Test " & iload & " - There are " & iCount & " elements on this page: " &  sMenuItem) End Sub Sub Finish sTextOutput.WriteLine("Testing completed at " & Date & " " & Time)  MsgBox "Testing has finished" & VbCrLf & "Please Check the Log", 0, "Result"End Sub'---------------------------------------------------------Sub Reload set wshShell = WScript.CreateObject("WScript.Shell") wshShell.AppActivate "The Internet - Windows Internet Explorer" WScript.Sleep 1500 wshShell.sendkeys"{F5}" WScript.Sleep 2000 iLoad = iLoad + 1 End Sub'---------------------------------------------------------Sub Include(otherFile) Dim oFSO : Set oFSO = CreateObject("Scripting.FileSystemObject") Dim oFile : Set oFile = oFSO.OpenTextFile(otherFile, 1) Dim sStr : sStr = oFile.ReadAll oFile.Close ExecuteGlobal sStrEnd Sub'---------------------------------------------------------------Include "test.vbs"'----------------------------------------------------------------'next filr(test.vbs)Option ExplicitCall HeaderoIE.Navigate "https://the-internet.herokuapp.com/disappearing_elements"Call WaitForLoadDo While iLoad <= 10 Call CountElements Call Result sMenuItem = "" Call Reload LoopCall Finish
